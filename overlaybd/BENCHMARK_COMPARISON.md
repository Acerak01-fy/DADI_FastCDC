# åŸºå‡†æµ‹è¯•è„šæœ¬å¯¹æ¯”

## ä¸¤ä¸ªç‰ˆæœ¬çš„å¯¹æ¯”

| ç‰¹æ€§ | åŸºç¡€ç‰ˆ (benchmark_fastcdc.sh) | é«˜çº§ç‰ˆ (benchmark_fastcdc_advanced.sh) â­ |
|------|-------------------------------|------------------------------------------|
| **æµ‹è¯•æ¬¡æ•°** | å•æ¬¡æµ‹è¯• | å¯é…ç½®é‡å¤æµ‹è¯•ï¼ˆé»˜è®¤5æ¬¡ï¼‰ |
| **ç»“æœå¯é æ€§** | ä¸€æ¬¡æµ‹è¯•,å¯èƒ½å—ç³»ç»Ÿæ³¢åŠ¨å½±å“ | å¤šæ¬¡æµ‹è¯•å–å¹³å‡å€¼,ç»“æœæ›´ç¨³å®š |
| **è¾“å‡ºæ ¼å¼** | çº¯æ–‡æœ¬ | æ–‡æœ¬ + CSVï¼ˆé€‚åˆExcelåˆ†æï¼‰ |
| **ç»Ÿè®¡åˆ†æ** | ä»…æ˜¾ç¤ºå•æ¬¡ç»“æœ | è‡ªåŠ¨è®¡ç®—å¹³å‡å€¼ã€æ ‡å‡†å·® |
| **æ€§èƒ½å¯¹æ¯”** | æ‰‹åŠ¨å¯¹æ¯” | è‡ªåŠ¨è®¡ç®—ç©ºé—´èŠ‚çœã€åŠ é€Ÿæ¯” |
| **æ•°æ®å¯è§†åŒ–** | éœ€æ‰‹åŠ¨æ•´ç†æ•°æ® | CSVå¯ç›´æ¥å¯¼å…¥å›¾è¡¨å·¥å…· |
| **é€‚ç”¨åœºæ™¯** | å¿«é€ŸéªŒè¯åŠŸèƒ½ | æ­£å¼æ€§èƒ½è¯„ä¼°ã€è®ºæ–‡æ•°æ® |

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›ç‚¹

### 1. å¤šæ¬¡é‡å¤æµ‹è¯• (å…³é”®ï¼)

**ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**

å•æ¬¡æµ‹è¯•å¯èƒ½å—åˆ°ä»¥ä¸‹å› ç´ å½±å“:
- CPUè°ƒåº¦æ³¢åŠ¨
- å†…å­˜ç¼“å­˜çŠ¶æ€
- ç£ç›˜I/Oæ³¢åŠ¨
- ç³»ç»Ÿåå°ä»»åŠ¡

**è§£å†³æ–¹æ¡ˆ:**
```bash
REPEAT_COUNT=5  # æ¯ä¸ªæµ‹è¯•é‡å¤5æ¬¡
```

**ç¤ºä¾‹è¾“å‡º:**
```
>>> æµ‹è¯•: mixed_10m (å¤§å°: 10240KB, ç±»å‹: mixed)
    é‡å¤ 5 æ¬¡ä»¥ç¡®ä¿ç»“æœç¨³å®šæ€§...
    è¿è¡Œ 1/5: âœ“ (å›ºå®š: 97ms/1613ms, FastCDC: 104ms/72ms)
    è¿è¡Œ 2/5: âœ“ (å›ºå®š: 95ms/1608ms, FastCDC: 102ms/70ms)
    è¿è¡Œ 3/5: âœ“ (å›ºå®š: 98ms/1620ms, FastCDC: 105ms/74ms)
    è¿è¡Œ 4/5: âœ“ (å›ºå®š: 96ms/1615ms, FastCDC: 103ms/71ms)
    è¿è¡Œ 5/5: âœ“ (å›ºå®š: 97ms/1611ms, FastCDC: 104ms/73ms)
```

### 2. CSVè¾“å‡ºæ ¼å¼

#### A. è¯¦ç»†æ•°æ® (benchmark_results.csv)

**åŒ…å«æ¯æ¬¡æµ‹è¯•çš„åŸå§‹æ•°æ®:**

```csv
Timestamp,RunID,TestName,DataType,FileSizeKB,OriginalBytes,Method,CompressedBytes,CompressionRatio,CompressTime_ms,DecompressTime_ms,MD5Verified
2025-11-09 14:30:01,1,mixed_10m,mixed,10240,10485760,Fixed,2831360,27.0,97,1613,true
2025-11-09 14:30:02,1,mixed_10m,mixed,10240,10485760,FastCDC,216064,2.06,104,72,true
2025-11-09 14:30:03,2,mixed_10m,mixed,10240,10485760,Fixed,2831360,27.0,95,1608,true
2025-11-09 14:30:04,2,mixed_10m,mixed,10240,10485760,FastCDC,216064,2.06,102,70,true
...
```

**ç”¨é€”:**
- æ£€æŸ¥å•æ¬¡å¼‚å¸¸å€¼
- ç»˜åˆ¶æ—¶é—´åºåˆ—å›¾
- éªŒè¯æµ‹è¯•ä¸€è‡´æ€§

#### B. ç»Ÿè®¡æ±‡æ€» (benchmark_summary.csv)

**åŒ…å«å¹³å‡å€¼å’Œæ ‡å‡†å·®:**

```csv
TestName,Method,AvgCompressedBytes,StdCompressedBytes,AvgCompressionRatio,StdCompressionRatio,SpaceSaving%,SpeedupDecompress
mixed_10m,Fixed,2831360.00,0.00,27.00,0.00,-,-
mixed_10m,FastCDC,216064.00,0.00,2.06,0.00,92.27,22.40
```

**ç”¨é€”:**
- è®ºæ–‡æ•°æ®è¡¨æ ¼
- æ€§èƒ½å¯¹æ¯”æŠ¥å‘Š
- å¿«é€ŸæŸ¥çœ‹ç»“æœ

### 3. è‡ªåŠ¨ç»Ÿè®¡åˆ†æ

**Pythonè„šæœ¬è‡ªåŠ¨è®¡ç®—:**

```python
# å¹³å‡å€¼
avg = sum(values) / len(values)

# æ ‡å‡†å·®
std = sqrt(sum((x - avg)^2) / (n-1))

# ç©ºé—´èŠ‚çœ
space_saving = (fixed_size - fastcdc_size) / fixed_size * 100

# åŠ é€Ÿæ¯”
speedup = fixed_time / fastcdc_time
```

**è¾“å‡ºç¤ºä¾‹:**
```
æµ‹è¯•åç§°             æ–¹æ³•       å¹³å‡å‹ç¼©ç‡   ç©ºé—´èŠ‚çœ     è§£å‹åŠ é€Ÿ
-------------------- ---------- ------------ ------------ ------------
mixed_10m            FastCDC     2.06%Â±0.05%  92.27%      22.40x
                                 ^^^^^^
                                 è¡¨ç¤ºç»“æœéå¸¸ç¨³å®šï¼
```

### 4. æ ‡å‡†å·®çš„æ„ä¹‰

**æ ‡å‡†å·® < 5%** âœ… ç»“æœå¯é 
```
AvgCompressionRatio: 2.06%
StdCompressionRatio: 0.05%
ç›¸å¯¹æ ‡å‡†å·®: 0.05/2.06 = 2.4% âœ“ éå¸¸å¥½ï¼
```

**æ ‡å‡†å·® > 10%** âš ï¸ éœ€è¦è°ƒæŸ¥
```
AvgDecompressTime: 72ms
StdDecompressTime: 15ms
ç›¸å¯¹æ ‡å‡†å·®: 15/72 = 20.8% âœ— æ³¢åŠ¨å¤ªå¤§

å¯èƒ½åŸå› :
- ç³»ç»Ÿè´Ÿè½½ä¸ç¨³å®š
- æµ‹è¯•æ¬¡æ•°ä¸è¶³
- éœ€è¦å¢åŠ  REPEAT_COUNT
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯1: å¿«é€ŸéªŒè¯åŠŸèƒ½

```bash
# ä½¿ç”¨åŸºç¡€ç‰ˆ
./benchmark_fastcdc.sh
```

### åœºæ™¯2: æ­£å¼æ€§èƒ½è¯„ä¼°ï¼ˆæ¨èï¼‰

```bash
# ä½¿ç”¨é«˜çº§ç‰ˆ
./benchmark_fastcdc_advanced.sh

# ç»“æœåˆ†æ
cd /home/wfy/DADI_OverlayBD_demo/experiments/fastcdc_benchmark
ls -lh *.csv
```

### åœºæ™¯3: è®ºæ–‡/æŠ¥å‘Šæ•°æ®

```bash
# å¢åŠ é‡å¤æ¬¡æ•°ä»¥è·å¾—æ›´å¯é çš„æ•°æ®
vim benchmark_fastcdc_advanced.sh
# ä¿®æ”¹: REPEAT_COUNT=10

./benchmark_fastcdc_advanced.sh

# åœ¨Excelä¸­æ‰“å¼€CSV
libreoffice benchmark_summary.csv
```

### åœºæ™¯4: æ€§èƒ½ç›‘æ§

```bash
# å®šæœŸè¿è¡Œæµ‹è¯•,å¯¹æ¯”å†å²æ•°æ®
./benchmark_fastcdc_advanced.sh
mv benchmark_results.csv results_$(date +%Y%m%d).csv
```

## ğŸ“Š æ•°æ®åˆ†æå·¥ä½œæµ

```
1. è¿è¡Œæµ‹è¯•
   â””â”€> benchmark_fastcdc_advanced.sh
        â”œâ”€> ç”Ÿæˆ benchmark_results.csv (åŸå§‹æ•°æ®)
        â””â”€> ç”Ÿæˆ benchmark_summary.csv (ç»Ÿè®¡æ•°æ®)

2. åˆæ­¥åˆ†æ
   â””â”€> æŸ¥çœ‹ç»ˆç«¯è¾“å‡ºçš„æ±‡æ€»è¡¨æ ¼
        â””â”€> æ£€æŸ¥æ ‡å‡†å·®æ˜¯å¦ < 5%

3. æ·±åº¦åˆ†æ
   â””â”€> æ‰“å¼€ Excel/LibreOffice
        â”œâ”€> åˆ›å»ºæ•°æ®é€è§†è¡¨
        â”œâ”€> ç»˜åˆ¶å¯¹æ¯”å›¾è¡¨
        â”‚    â”œâ”€> å‹ç¼©ç‡å¯¹æ¯”å›¾
        â”‚    â”œâ”€> é€Ÿåº¦å¯¹æ¯”å›¾
        â”‚    â””â”€> ç©ºé—´èŠ‚çœè¶‹åŠ¿
        â””â”€> å¯¼å‡ºå›¾è¡¨åˆ°æŠ¥å‘Š

4. Pythonåˆ†æ (å¯é€‰)
   â””â”€> ä½¿ç”¨ pandas/matplotlib
        â”œâ”€> å¼‚å¸¸å€¼æ£€æµ‹
        â”œâ”€> ç›¸å…³æ€§åˆ†æ
        â””â”€> é«˜çº§å¯è§†åŒ–
```

## ğŸ“ˆ é¢„æœŸç»“æœç¤ºä¾‹

### ç†æƒ³çš„æµ‹è¯•æŠ¥å‘Š

```
========================================
ç»Ÿè®¡æ‘˜è¦é¢„è§ˆ:
----------------------------------------
æµ‹è¯•åç§°             æ–¹æ³•       å¹³å‡å‹ç¼©ç‡    ç©ºé—´èŠ‚çœ    è§£å‹åŠ é€Ÿ
-------------------- ---------- ------------ ------------ ------------
random_10m           FastCDC    100.5%Â±0.2%   -0.5%       0.98x
                                 ğŸ‘† ä¸å¯å‹ç¼©æ•°æ®,FastCDCæ²¡æœ‰åŠ£åŠ¿

pattern_10m          FastCDC      0.8%Â±0.1%   75.2%      45.3x
                                 ğŸ‘† é«˜åº¦å¯å‹ç¼©,ä¸¤è€…éƒ½å¾ˆå¥½,FastCDCç•¥ä¼˜

mixed_10m            FastCDC      2.1%Â±0.1%   92.3%      22.4x
                                 ğŸ‘† çœŸå®åœºæ™¯,FastCDCå·¨å¤§ä¼˜åŠ¿ï¼âœ¨
```

### CSVæ•°æ®åœ¨Excelä¸­çš„æ ·å­

| TestName | Method | AvgRatio | StdRatio | SpaceSaving | SpeedupDecomp |
|----------|--------|----------|----------|-------------|---------------|
| random_10m | Fixed | 100.2 | 0.3 | - | - |
| random_10m | FastCDC | 100.5 | 0.2 | -0.5 | 0.98 |
| mixed_10m | Fixed | 27.0 | 0.0 | - | - |
| mixed_10m | FastCDC | 2.1 | 0.1 | **92.3** | **22.4** |

ç„¶ååˆ›å»ºæŸ±çŠ¶å›¾:
```
      å‹ç¼©ç‡å¯¹æ¯”              è§£å‹æ—¶é—´å¯¹æ¯”
        (%)                     (ms)
      â”Œâ”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”
100%  â”‚â–ˆâ–ˆ  â”‚                  â”‚    â”‚ 1600
      â”‚â–ˆâ–ˆ  â”‚                  â”‚    â”‚ 
50%   â”‚â–ˆâ–ˆ  â”‚                  â”‚    â”‚ 800
      â”‚â–ˆâ–ˆ  â”‚                  â”‚ â–ˆâ–ˆ â”‚
0%    â”‚â–ˆâ–ˆ  â”‚                  â”‚ â–ˆâ–ˆ â”‚ 0
      â””â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”˜
      Fixed FastCDC           Fixed FastCDC
```

## ğŸ“ æ€»ç»“

**é€‰æ‹©é«˜çº§ç‰ˆçš„ç†ç”±:**

1. âœ… **å¯é æ€§**: å¤šæ¬¡æµ‹è¯•æ¶ˆé™¤ç³»ç»Ÿæ³¢åŠ¨å½±å“
2. âœ… **ä¸“ä¸šæ€§**: CSVæ ¼å¼é€‚åˆå­¦æœ¯/å•†ä¸šæŠ¥å‘Š
3. âœ… **å¯åˆ†æ**: æ ‡å‡†å·®å¸®åŠ©åˆ¤æ–­ç»“æœè´¨é‡
4. âœ… **çœæ—¶é—´**: è‡ªåŠ¨ç»Ÿè®¡åˆ†æ,æ— éœ€æ‰‹å·¥è®¡ç®—
5. âœ… **å¯è¿½æº¯**: åŸå§‹æ•°æ®ä¿å­˜,å¯é‡æ–°åˆ†æ

**é€‚ç”¨åœºæ™¯:**
- ğŸ“„ è®ºæ–‡å®éªŒæ•°æ®
- ğŸ“Š æ€§èƒ½è¯„ä¼°æŠ¥å‘Š
- ğŸ”¬ æ·±åº¦æ€§èƒ½åˆ†æ
- ğŸ“ˆ é•¿æœŸæ€§èƒ½ç›‘æ§

**åŸºç¡€ç‰ˆé€‚ç”¨:**
- ğŸ§ª å¿«é€ŸåŠŸèƒ½éªŒè¯
- ğŸ› è°ƒè¯•é—®é¢˜
- ğŸ‘€ å¿«é€ŸæŸ¥çœ‹æ€§èƒ½

---

**å»ºè®®**: æ­£å¼æµ‹è¯•ä½¿ç”¨é«˜çº§ç‰ˆ,æ—¥å¸¸è°ƒè¯•ä½¿ç”¨åŸºç¡€ç‰ˆã€‚
